<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Korea Visual Diary ‚Äì My Korea Memory Map</title>

  <!-- Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Gowun+Dodum&family=Nanum+Myeongjo:wght@400;700;800&display=swap" rel="stylesheet">

  <!-- Leaflet -->
  <link
    rel="stylesheet"
    href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
    integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY="
    crossorigin=""
  />
  <script
    src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"
    integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo="
    crossorigin=""
  ></script>

  <style>
    :root {
      --bg1: #504E76;
      --bg2: #C4C3E3;
      --sand: #FDF8E2;
      --leaf: #A3B565;
      --sun: #FCDD9D;
      --accent: #F1642E;
      --card: #ffffff;
      --ink: #252336;
      --muted: #b9b6d6;
      --glass: rgba(255,255,255,0.12);
      --glass-border: rgba(255,255,255,0.35);
      --shadow-soft: 0 18px 40px rgba(0,0,0,.28);
      --radius-xl: 26px;
      --radius-lg: 18px;
    }

    * {
      box-sizing: border-box;
    }

    html, body {
      margin: 0;
      height: 100%;
      font-family: "Gowun Dodum", "Noto Sans KR", system-ui, -apple-system, "Segoe UI", Roboto, sans-serif;
      color: var(--sand);
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
    }

    body {
      background: radial-gradient(circle at 20% 0%, var(--sun) 0, transparent 50%),
                  radial-gradient(circle at 80% 0%, #E4E3FF 0, transparent 50%),
                  linear-gradient(180deg, var(--bg1), var(--bg2));
      display: flex;
      align-items: stretch;
      justify-content: center;
      padding: 20px;
      min-height: 100vh;
    }

    .app {
      width: 100%;
      max-width: 1280px;
      background: linear-gradient(135deg, rgba(255,255,255,0.12), rgba(255,255,255,0.04));
      border-radius: var(--radius-xl);
      border: 1px solid rgba(255,255,255,.25);
      box-shadow: var(--shadow-soft);
      backdrop-filter: blur(22px) saturate(150%);
      display: flex;
      flex-direction: column;
      padding: 18px 22px;
    }

    /* HEADER */
    .app-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 16px;
      margin-bottom: 10px;
      flex-wrap: wrap;
    }

    .title-block h1 {
      margin: 0;
      font-size: 22px;
      letter-spacing: .05em;
      text-transform: uppercase;
      color: #fff;
      font-family: "Nanum Myeongjo", "Gowun Dodum", "Noto Sans KR", serif;
      font-weight: 700;
    }

    .title-block p {
      margin: 2px 0 0;
      font-size: 13px;
      color: rgba(253,248,226,0.7);
      text-shadow: 0 1px 2px rgba(0,0,0,0.3);
    }

    .header-right {
      display: flex;
      align-items: center;
      gap: 10px;
      flex-wrap: wrap;
      justify-content: flex-end;
      min-width: 0;
    }

    .year-filters {
      display: flex;
      gap: 8px;
      flex-wrap: wrap;
    }

    .year-chip {
      border-radius: 999px;
      border: 1px solid rgba(255,255,255,.35);
      background: rgba(0,0,0,.12);
      color: #fdfdfd;
      font-size: 13px;
      padding: 7px 13px;
      cursor: pointer;
      display: flex;
      align-items: center;
      gap: 4px;
      backdrop-filter: blur(16px);
      transition: background .2s ease, transform .15s ease, box-shadow .2s ease, border-color .2s ease;
      font-family: "Gowun Dodum", sans-serif;
    }

    .year-chip:hover:not(.disabled):not(.active) {
      transform: translateY(-1px);
      background: rgba(0,0,0,.2);
    }

    .year-chip span.count {
      font-size: 11px;
      opacity: .9;
    }

    .year-chip.active {
      background: var(--accent);
      border-color: rgba(255,255,255,.75);
      box-shadow: 0 0 16px rgba(241,100,46,.45);
      transform: translateY(-1px);
    }

    .year-chip.disabled {
      opacity: .45;
      cursor: default;
    }

    .music-toggle {
      border-radius: 999px;
      border: 1px solid rgba(255,255,255,.45);
      background: rgba(0,0,0,.18);
      color: #fff;
      font-size: 12px;
      padding: 6px 12px;
      display: flex;
      align-items: center;
      gap: 6px;
      cursor: pointer;
      backdrop-filter: blur(16px);
      transition: background .2s ease, transform .1s ease, box-shadow .2s ease;
      font-family: "Gowun Dodum", sans-serif;
    }

    .music-toggle:hover {
      background: rgba(0,0,0,.28);
      transform: translateY(-1px);
      box-shadow: 0 6px 18px rgba(0,0,0,.35);
    }

    /* LAYOUT: 3 COLUMNS */
    .content {
      display: grid;
      grid-template-columns: minmax(0, 1.3fr) minmax(0, 1.6fr) minmax(0, 1.6fr);
      gap: 16px;
      margin-top: 6px;
      min-height: 520px;
    }

    @media (max-width: 1080px) {
      .content {
        grid-template-columns: minmax(0, 1.1fr) minmax(0, 1.3fr);
        grid-template-areas:
          "left center"
          "right right";
      }
      .left-panel { grid-area: left; }
      .center-panel { grid-area: center; }
      .right-panel { grid-area: right; }
    }

    @media (max-width: 800px) {
      .content {
        grid-template-columns: 1fr;
        grid-template-areas:
          "center"
          "left"
          "right";
      }
    }

    /* PANELS */
    .left-panel,
    .center-panel,
    .right-panel {
      border-radius: var(--radius-lg);
      background: rgba(7,5,25,.78);
      border: 1px solid var(--glass-border);
      box-shadow: var(--shadow-soft);
      backdrop-filter: blur(26px) saturate(160%);
      padding: 14px 14px 12px;
      display: flex;
      flex-direction: column;
      gap: 10px;
      min-height: 0;
    }

    .left-panel {
      background: radial-gradient(circle at 0 0, rgba(252,221,157,.16), transparent 60%),
                  rgba(7,5,25,.8);
    }

    .center-panel {
      background: radial-gradient(circle at 50% 0, rgba(163,181,101,.14), transparent 60%),
                  rgba(7,5,25,.84);
    }

    .right-panel {
      background: radial-gradient(circle at 100% 0, rgba(252,221,157,.18), transparent 60%),
                  radial-gradient(circle at 0 100%, rgba(163,181,101,.18), transparent 60%),
                  rgba(7,5,25,.9);
    }

    /* LEFT: FILTERS + LIST */
    .filters-row {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
      margin-top: 2px;
    }

    .tag {
      font-size: 11px;
      padding: 5px 10px;
      border-radius: 999px;
      border: 1px solid rgba(255,255,255,.27);
      color: #fdfdfd;
      background: rgba(0,0,0,.18);
      cursor: pointer;
      backdrop-filter: blur(14px);
      display: flex;
      align-items: center;
      gap: 4px;
      transition: background .2s, transform .15s, box-shadow .2s, border-color .2s;
      font-family: "Gowun Dodum", sans-serif;
    }

    .tag:hover:not(.disabled):not(.active) {
      transform: translateY(-1px);
      background: rgba(0,0,0,.25);
    }

    .tag span.icon {
      font-size: 12px;
    }

    .tag.active {
      background: var(--leaf);
      border-color: rgba(255,255,255,.75);
      box-shadow: 0 0 14px rgba(163,181,101,.55);
      transform: translateY(-1px);
      color: #20201c;
    }

    .tag.disabled {
      opacity: .4;
      cursor: default;
    }

    .place-list {
      margin-top: 4px;
      flex: 1;
      min-height: 180px;
      max-height: 100%;
      overflow-y: auto;
      overflow-x: hidden;
      padding-right: 6px;
    }

    .place-list::-webkit-scrollbar {
      width: 6px;
    }

    .place-list::-webkit-scrollbar-track {
      background: rgba(0,0,0,.2);
      border-radius: 3px;
    }

    .place-list::-webkit-scrollbar-thumb {
      background: rgba(255,255,255,.3);
      border-radius: 3px;
    }

    .place-card {
      background: rgba(15,12,40,.75);
      border-radius: 14px;
      padding: 8px 10px;
      margin-bottom: 6px;
      border: 1px solid rgba(255,255,255,.08);
      cursor: pointer;
      display: flex;
      flex-direction: column;
      gap: 2px;
      transition: background .18s ease, transform .12s ease, box-shadow .18s ease, border-color .18s ease;
    }

    .place-card:hover {
      transform: translateY(-2px);
      box-shadow: 0 10px 26px rgba(0,0,0,.55);
      border-color: rgba(252,221,157,.55);
    }

    .place-card.active {
      background: linear-gradient(135deg, rgba(252,221,157,.65), rgba(241,100,46,.75));
      border-color: rgba(255,255,255,.85);
      box-shadow: 0 12px 30px rgba(241,100,46,.7);
      color: #201b2a;
    }

    .place-main {
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 6px;
    }

    .place-name {
      font-size: 13px;
      font-weight: 600;
      font-family: "Nanum Myeongjo", "Gowun Dodum", "Noto Sans KR", serif;
    }

    .place-type {
      font-size: 11px;
      text-transform: uppercase;
      letter-spacing: .11em;
      opacity: .85;
      white-space: nowrap;
    }

    .place-meta {
      font-size: 11px;
      opacity: .85;
    }

    /* CENTER: MAP */
    .map-shell {
      position: relative;
      border-radius: var(--radius-lg);
      padding: 12px;
      background: linear-gradient(145deg, rgba(0,0,0,0.35), rgba(0,0,0,0.75));
      overflow: hidden;
      min-height: 260px;
      flex: 1;
      display: flex;
      flex-direction: column;
      gap: 10px;
    }

    .map-globe {
      position: relative;
      width: 100%;
      aspect-ratio: 1/1;
      border-radius: 999px;
      overflow: hidden;
      box-shadow: 0 20px 50px rgba(0,0,0,.7);
      border: 2px solid rgba(255,255,255,.15);
    }

    .map-globe .leaflet-container {
      width: 100%;
      height: 100%;
      background: #1a1a2e;
    }

    .map-globe .leaflet-tile-pane {
      filter: brightness(0.85) contrast(1.1) saturate(0.9);
    }

    .map-caption {
      font-size: 11px;
      color: rgba(253,248,226,.9);
      background: rgba(0,0,0,.35);
      padding: 4px 8px;
      border-radius: 999px;
      backdrop-filter: blur(10px);
      align-self: flex-start;
    }

    .map-category-badge {
      position: absolute;
      right: 14px;
      top: 12px;
      font-size: 11px;
      color: #201b2a;
      background: rgba(253,248,226,.95);
      padding: 5px 10px;
      border-radius: 999px;
      display: flex;
      align-items: center;
      gap: 4px;
      box-shadow: 0 6px 18px rgba(0,0,0,.35);
      z-index: 1000;
      pointer-events: none;
      font-family: "Gowun Dodum", sans-serif;
    }

    /* RIGHT: PHOTOS + MEMORY */
    .memory-header {
      display: flex;
      justify-content: space-between;
      align-items: flex-start;
      gap: 8px;
    }

    .memory-title {
      font-size: 18px;
      font-weight: 700;
      color: #fff;
      margin: 0;
      font-family: "Nanum Myeongjo", "Gowun Dodum", "Noto Sans KR", serif;
    }

    .memory-type-pill {
      font-size: 11px;
      padding: 4px 9px;
      border-radius: 999px;
      background: rgba(0,0,0,.35);
      border: 1px solid rgba(255,255,255,.25);
      text-transform: uppercase;
      letter-spacing: .12em;
      display: flex;
      align-items: center;
      gap: 4px;
      font-family: "Gowun Dodum", sans-serif;
      white-space: nowrap;
    }

    .memory-sub {
      font-size: 13px;
      color: var(--sun);
      margin: 2px 0 0;
    }

    .meta-grid {
      display: grid;
      grid-template-columns: repeat(2, minmax(0,1fr));
      gap: 6px 10px;
      margin-top: 6px;
      font-size: 11.5px;
      color: rgba(253,248,226,.9);
    }

    .meta-label {
      opacity: .7;
    }

    .photo-section-title {
      margin: 10px 0 4px;
      font-size: 11px;
      letter-spacing: .16em;
      text-transform: uppercase;
      color: var(--muted);
      font-family: "Nanum Myeongjo", "Gowun Dodum", "Noto Sans KR", serif;
    }

    .photo-grid {
      border-radius: 14px;
      border: 1px solid rgba(255,255,255,.25);
      background: radial-gradient(circle at 0 0, rgba(255,255,255,.12), transparent 70%),
                  rgba(9,7,30,.92);
      padding: 10px;
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(100px, 1fr));
      gap: 12px;
      max-height: 280px;
      overflow-y: auto;
    }

    .photo-grid::-webkit-scrollbar {
      width: 6px;
    }

    .photo-grid::-webkit-scrollbar-thumb {
      background: rgba(255,255,255,.35);
      border-radius: 3px;
    }

    .photo-item {
      position: relative;
      border-radius: 10px;
      overflow: hidden;
      background: #16132a;
      aspect-ratio: 4/3;
      box-shadow: 0 8px 18px rgba(0,0,0,.55);
    }

    .photo-item img {
      width: 100%;
      height: 100%;
      object-fit: cover;
      display: block;
      transition: transform .25s ease, filter .25s ease;
    }

    .photo-item:hover img {
      transform: scale(1.05);
      filter: brightness(1.05);
    }

    .photo-empty {
      font-size: 12px;
      color: var(--muted);
      padding: 20px;
      text-align: center;
      grid-column: 1 / -1;
    }

    .photo-loading {
      font-size: 11px;
      color: var(--sun);
      padding: 15px;
      text-align: center;
      grid-column: 1 / -1;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
    }

    .photo-loading::before {
      content: '';
      width: 16px;
      height: 16px;
      border: 2px solid var(--sun);
      border-top-color: transparent;
      border-radius: 50%;
      animation: spin 0.8s linear infinite;
    }

    @keyframes spin {
      to { transform: rotate(360deg); }
    }

    .glass-grid {
      margin-top: 10px;
      display: grid;
      grid-template-columns: repeat(2, minmax(0,1fr));
      gap: 8px;
    }

    .glass-cell {
      border-radius: 12px;
      padding: 10px;
      border: 1px solid rgba(255,255,255,.35);
      background: linear-gradient(135deg, rgba(7,5,25,.85), rgba(7,5,25,.75));
      backdrop-filter: blur(10px);
      color: #FDF8E2;
      font-size: 11.5px;
      box-shadow: 0 8px 22px rgba(0,0,0,.35);
      min-height: 56px;
    }

    .glass-cell h4 {
      margin: 0 0 4px;
      font-size: 11px;
      letter-spacing: .12em;
      text-transform: uppercase;
      color: #fff;
      font-family: "Nanum Myeongjo", "Gowun Dodum", "Noto Sans KR", serif;
      font-weight: 700;
      text-shadow: 0 1px 3px rgba(0,0,0,0.5);
    }

    .glass-cell p {
      margin: 0;
      color: #FDF8E2;
      font-family: "Gowun Dodum", sans-serif;
      font-weight: 500;
      line-height: 1.5;
      text-shadow: 0 1px 2px rgba(0,0,0,0.4);
    }

    .memory-foot {
      margin-top: auto;
      display: flex;
      justify-content: space-between;
      align-items: center;
      font-size: 11px;
      color: rgba(253,248,226,.75);
      flex-wrap: wrap;
      gap: 8px;
    }

    .pill-small {
      border-radius: 999px;
      border: 1px solid rgba(255,255,255,.22);
      padding: 3px 8px;
      background: rgba(0,0,0,.28);
    }

    /* Memory card fade animation */
    .memory-content {
      animation: fadeIn 0.3s ease-in-out;
    }

    @keyframes fadeIn {
      from {
        opacity: 0;
        transform: translateY(4px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    /* Leaflet popup styling */
    .custom-marker {
      background: transparent;
      border: none;
    }

    .leaflet-popup-content-wrapper {
      background: rgba(7,5,25,.95);
      color: var(--sand);
      border-radius: 12px;
      backdrop-filter: blur(20px);
      border: 1px solid rgba(255,255,255,.2);
    }

    .leaflet-popup-content {
      margin: 12px 14px;
      font-family: "Gowun Dodum", sans-serif;
      font-size: 12px;
    }

    .leaflet-popup-content b {
      font-family: "Nanum Myeongjo", serif;
      font-weight: 700;
      color: #fff;
    }

    .leaflet-popup-tip {
      background: rgba(7,5,25,.95);
      border: 1px solid rgba(255,255,255,.2);
    }

    @media (max-width: 640px) {
      body {
        padding: 10px;
      }
      .app {
        padding: 14px 16px;
      }
      .title-block h1 {
        font-size: 18px;
      }
      .map-shell {
        min-height: 220px;
      }
    }

    /* Sparkles effect */
    .sparkle {
      position: fixed;
      pointer-events: none;
      width: 8px;
      height: 8px;
      border-radius: 50%;
      background: radial-gradient(circle, #FCDD9D 0%, #F1642E 100%);
      box-shadow: 0 0 6px #FCDD9D, 0 0 12px #F1642E;
      z-index: 10000;
      animation: sparkleFloat 1.2s ease-out forwards;
    }

    @keyframes sparkleFloat {
      0% {
        opacity: 1;
        transform: translate(0, 0) scale(1);
      }
      100% {
        opacity: 0;
        transform: translate(var(--tx), var(--ty)) scale(0.3);
      }
    }

    .sparkle-small {
      width: 4px;
      height: 4px;
      box-shadow: 0 0 4px #FCDD9D, 0 0 8px #F1642E;
    }

    .sparkle-large {
      width: 12px;
      height: 12px;
      box-shadow: 0 0 8px #FCDD9D, 0 0 16px #F1642E;
    }
  </style>
</head>
<body>
  <div class="app">
    <header class="app-header">
      <div class="title-block">
        <h1>Korea Visual Diary ‚Äì My Korea Memory Map</h1>
        <p>Places ¬∑ Years ¬∑ Feelings ‚Äî a personal map-based memory project</p>
      </div>
      <div class="header-right">
        <button class="music-toggle" id="musicToggle" type="button">
          <span class="icon">üéß</span><span class="label">Play BTS instrumental</span>
        </button>
        <div class="year-filters" id="yearFilters"></div>
      </div>
    </header>

    <main class="content">
      <!-- LEFT: FILTERS + LIST -->
      <section class="left-panel">
        <div class="filters-row" id="typeFilters"></div>
        <div class="place-list" id="placeList"></div>
      </section>

      <!-- CENTER: MAP -->
      <section class="center-panel">
        <div class="map-shell">
          <div class="map-globe" id="map"></div>
          <div class="map-category-badge" id="mapCategoryBadge">
            <span class="icon">‚ú®</span><span class="label">All places</span>
          </div>
          <div class="map-caption">
            Hover markers to see names. Click a marker or list item to open the memory card on the right.
          </div>
        </div>
      </section>

      <!-- RIGHT: PHOTOS + MEMORY -->
      <section class="right-panel" id="memoryPanel">
        <div class="memory-header">
          <div>
            <h2 class="memory-title" id="memTitle">Choose a place</h2>
            <p class="memory-sub" id="memSub">Select a pin on the map or a place from the list to open your memory card.</p>
          </div>
          <div class="memory-type-pill" id="memType">
            <span class="icon">‚ú®</span><span>TYPE</span>
          </div>
        </div>

        <div class="meta-grid memory-content">
          <div>
            <div class="meta-label">City</div>
            <div id="memCity">‚Äì</div>
          </div>
          <div>
            <div class="meta-label">Year</div>
            <div id="memYear">‚Äì</div>
          </div>
          <div style="grid-column:1 / -1;">
            <div class="meta-label">Address</div>
            <div id="memAddress">‚Äì</div>
          </div>
        </div>

        <h4 class="photo-section-title">Photos from this place</h4>
        <div class="photo-grid memory-content" id="photoGrid">
          <div class="photo-empty">
            No photos loaded yet. Choose a place on the left or center to see its gallery.
          </div>
        </div>

        <div class="glass-grid memory-content">
          <div class="glass-cell">
            <h4>Memory</h4>
            <p id="memNote">
              Here I will write my personal memory or one-sentence insight about this place.
            </p>
          </div>
          <div class="glass-cell">
            <h4>Details &amp; Tips</h4>
            <p id="memTip">
              Food recommendations, best time to visit, who I went with, or any small detail I want to remember.
            </p>
          </div>
        </div>

        <div class="memory-foot">
          <span>‚Üê Click another pin or list item to update this card.</span>
          <span class="pill-small" id="memBadge">0 / 0 places</span>
        </div>
      </section>
    </main>
  </div>

  <!-- Background music -->
  <audio id="bgMusic" loop src="assets/music/bts_instrumental.mp3"></audio>

  <script>
    /* ---------------------------
       CATEGORY CONFIG (ENGLISH)
       --------------------------- */
    const CATEGORY_CONFIG = {
      all:     { key: 'all',     label: 'All',         icon: '‚ú®' },
      cafe:    { key: 'cafe',    label: 'Caf√©',        icon: '‚òï' },
      food:    { key: 'food',    label: 'Food',        icon: 'üçú' },
      nature:  { key: 'nature',  label: 'Nature',      icon: 'üåø' },
      exp:     { key: 'exp',     label: 'Experiences', icon: 'üé¢' },
      culture: { key: 'culture', label: 'Art & Culture', icon: 'üñºÔ∏è' },
      study:   { key: 'study',   label: 'Study',       icon: 'üìö' },
      daily:   { key: 'daily',   label: 'Daily life',  icon: 'üèôÔ∏è' },
      market:  { key: 'market',  label: 'Market',      icon: 'üõí' },
      etc:     { key: 'etc',     label: 'Other',       icon: '‚≠ê' }
    };

    /* ---------------------------
       PLACES DATA 2022‚Äì2025
       note = English memory
       folder = subfolder under assets/images/{year}/
       --------------------------- */
    const places = [
      // 2022
      {
        id: 1,
        name: "Í≥µÍ∞úÏ†ïÏõê",
        type: "cafe",
        city: "Í≤ΩÍ∏∞ Î∂ÄÏ≤ú",
        address: "Í≤ΩÍ∏∞ Î∂ÄÏ≤úÏãú ÏõêÎØ∏Íµ¨ Ïû•ÎßêÎ°ú362Î≤àÍ∏∏ 31 1Ï∏µ",
        year: 2022,
        note: `A cozy caf√© near Bucheon University where Angelina and I often studied together.`,
        folder: "Í≥µÍ∞úÏ†ïÏõê"
      },
      {
        id: 2,
        name: "ÏïàÏÑ± ÎÇ¥Î¶¨",
        type: "home",
        city: "Í≤ΩÍ∏∞ ÏïàÏÑ±",
        address: "Í≤ΩÍ∏∞ ÏïàÏÑ±Ïãú ÎåÄÎçïÎ©¥ ÎåÄÌïô6Í∏∏ 4",
        year: 2022,
        note: `Farangiz‚Äôs home in Anseong, where I stayed for about half a month.`,
        folder: "ÏïàÏÑ± ÎÇ¥Î¶¨"
      },
      {
        id: 3,
        name: "Everland",
        type: "adventure",
        city: "Í≤ΩÍ∏∞ Ïö©Ïù∏",
        address: "Í≤ΩÍ∏∞ Ïö©Ïù∏Ïãú Ï≤òÏù∏Íµ¨ Ìè¨Í≥°Ïùç ÏóêÎ≤ÑÎûúÎìúÎ°ú 199",
        year: 2022,
        note: `A full day in one of Korea‚Äôs most famous theme parks.`,
        folder: "Everland"
      },
      {
        id: 4,
        name: "Itaewon",
        type: "cafe",
        city: "ÏÑúÏö∏",
        address: "ÏÑúÏö∏ Ïö©ÏÇ∞Íµ¨ Ïù¥ÌÉúÏõêÎ°ú ÏßÄÌïò 177",
        year: 2022,
        note: `Visited different caf√©s, tried espresso for the first time, visited the Itaewon mosque and walked around Itaewon Class filming locations.`,
        folder: "Itaewon"
      },
      {
        id: 5,
        name: "Î∂ÄÏ≤úÎåÄÌïôÍµê",
        type: "university",
        city: "Í≤ΩÍ∏∞ Î∂ÄÏ≤ú",
        address: "Í≤ΩÍ∏∞ Î∂ÄÏ≤úÏãú ÏõêÎØ∏Íµ¨ Ïã†Ìù•Î°ú56Î≤àÍ∏∏ 25",
        year: 2022,
        note: `My first university in Korea ‚Äî many early memories and first steps.`,
        folder: "Î∂ÄÏ≤úÎåÄÌïôÍµê"
      },
      {
        id: 6,
        name: "Ìï®Î∞ïÎßàÏùÑ",
        type: "home",
        city: "Ïù∏Ï≤ú",
        address: "Ïù∏Ï≤ú Ïó∞ÏàòÍµ¨ Ïó∞Ïàò1Îèô",
        year: 2022,
        note: `A neighborhood in Incheon that became a temporary home.`,
        folder: "Ìï®Î∞ïÎßàÏùÑ"
      },

      // 2023
      {
        id: 7,
        name: "Îù†ÏïÑÌä∏",
        type: "art",
        city: "ÏÑúÏö∏",
        address: "ÏÑúÏö∏ ÎßàÌè¨Íµ¨ ÏôÄÏö∞ÏÇ∞Î°ú21Í∏∏ 20-11 ÏßÄÌïò1Ï∏µ",
        year: 2023,
        note: `An exhibition dedicated to The Little Prince watched together.`,
        folder: "Îù†ÏïÑÌä∏"
      },
      {
        id: 8,
        name: "ÏõêÎØ∏ÏÇ∞ÏßÑÎã¨ÎûòÏ∂ïÏ†ú",
        type: "park",
        city: "Í≤ΩÍ∏∞ Î∂ÄÏ≤ú",
        address: "Í≤ΩÍ∏∞ Î∂ÄÏ≤úÏãú ÏõêÎØ∏Íµ¨ Ï∂òÏùòÎèô 48-17",
        year: 2023,
        note: `Azalea festival on Wonmi Mountain, full of spring colors.`,
        folder: "ÏõêÎØ∏ÏÇ∞ÏßÑÎã¨ÎûòÏ∂ïÏ†ú"
      },
      {
        id: 9,
        name: "Í≤ΩÎ≥µÍ∂Å",
        type: "adventure",
        city: "ÏÑúÏö∏",
        address: "ÏÑúÏö∏ Ï¢ÖÎ°úÍµ¨ ÏÇ¨ÏßÅÎ°ú 161 1Ï∏µ",
        year: 2023,
        note: `My first hanbok experience with Katya at Gyeongbokgung Palace.`,
        folder: "Í≤ΩÎ≥µÍ∂Å"
      },
      {
        id: 10,
        name: "Ìò∏Ìò∏ÏãùÎãπ",
        type: "food",
        city: "ÏÑúÏö∏",
        address: "ÏÑúÏö∏ ÏÑ±ÎèôÍµ¨ ÏÑúÏö∏Ïà≤4Í∏∏ 25",
        year: 2023,
        note: `Hongdae walks, shopping, a delicious lunch, and bread with salt and kaymak.`,
        folder: "Ìò∏Ìò∏ÏãùÎãπ"
      },
      {
        id: 11,
        name: "Ïò§Î≤ÑÎî•",
        type: "cafe",
        city: "ÏÑúÏö∏",
        address: "ÏÑúÏö∏ ÎßàÌè¨Íµ¨ ÏÑ±ÎØ∏ÏÇ∞Î°ú 149-8 2-3Ï∏µ, Ïò•ÌÉë",
        year: 2023,
        note: `Ramadan evening with Katya in a rooftop caf√©.`,
        folder: "Ïò§Î≤ÑÎî•"
      },
      {
        id: 12,
        name: "Ïä§ÌÉÄÌïÑÎìú ÏàòÏõê",
        type: "adventure",
        city: "Í≤ΩÍ∏∞ ÏàòÏõê",
        address: "Í≤ΩÍ∏∞ ÏàòÏõêÏãú Ïû•ÏïàÍµ¨ ÏàòÏÑ±Î°ú 175 ÏßÄÌïò1,2Ï∏µ, 1~8Ï∏µ",
        year: 2023,
        note: `Exploring a huge Starfield shopping mall in Suwon.`,
        folder: "Ïä§ÌÉÄÌïÑÎìú ÏàòÏõê"
      },
      {
        id: 13,
        name: "Ìè¨Î†àÏä§Ìä∏ÏïÑÏõÉÌåÖÏä§",
        type: "cafe",
        city: "Ïù∏Ï≤ú",
        address: "Ïù∏Ï≤ú Ïó∞ÏàòÍµ¨ Ï≤≠ÎüâÎ°ú 145",
        year: 2023,
        note: `Green and cozy caf√© moments in Incheon.`,
        folder: "Ìè¨Î†àÏä§Ìä∏ÏïÑÏõÉÌåÖÏä§"
      },
      {
        id: 14,
        name: "RAINREPORT",
        type: "cafe",
        city: "ÏÑúÏö∏",
        address: "ÏÑúÏö∏ Ïö©ÏÇ∞Íµ¨ ÏÜåÏõîÎ°ú40Í∏∏ 85 1-2Ï∏µ",
        year: 2023,
        note: `A moody rainy-day caf√© with a beautiful view.`,
        folder: "RAINREPORT"
      },
      {
        id: 15,
        name: "HOOLIGAN COFFEE",
        type: "food",
        city: "ÏÑúÏö∏",
        address: "ÏÑúÏö∏ ÎßàÌè¨Íµ¨ ÏôÄÏö∞ÏÇ∞Î°ú29Î∞îÍ∏∏ 11-5 1Ï∏µ",
        year: 2023,
        note: `Coffee, brunch, and a little bit of Hongdae energy.`,
        folder: "HOOLIGAN COFFEE"
      },
      {
        id: 16,
        name: "London Bagel Museum Dosan",
        type: "food",
        city: "ÏÑúÏö∏",
        address: "ÏÑúÏö∏ Í∞ïÎÇ®Íµ¨ Ïñ∏Ï£ºÎ°ú168Í∏∏ 33 1,2Ï∏µ",
        year: 2023,
        note: `Bagels with a London mood in Dosan.`,
        folder: "London Bagel Museum Dosan"
      },
      {
        id: 17,
        name: "ÏïàÎ™©Ìï¥Î≥Ä",
        type: "adventure",
        city: "Í∞ïÎ¶â",
        address: "Í∞ïÏõêÌäπÎ≥ÑÏûêÏπòÎèÑ Í∞ïÎ¶âÏãú Ï∞ΩÌï¥Î°ú14Î≤àÍ∏∏ 51-26",
        year: 2023,
        note: `A beach day in Gangneung with sea breeze and coffee streets.`,
        folder: "ÏïàÎ™©Ìï¥Î≥Ä"
      },
      {
        id: 18,
        name: "ÏùÑÏôïÎ¶¨Ìï¥ÏàòÏöïÏû•",
        type: "adventure",
        city: "Ïù∏Ï≤ú",
        address: "Ïù∏Ï≤ú Ï§ëÍµ¨ ÏùÑÏôïÎèô 717-12",
        year: 2023,
        note: `Evening sea and sunset near Incheon at Eulwangri Beach.`,
        folder: "ÏùÑÏôïÎ¶¨Ìï¥ÏàòÏöïÏû•"
      },
      {
        id: 19,
        name: "Hangan Park",
        type: "park",
        city: "ÏÑúÏö∏",
        address: "ÏÑúÏö∏ ÏòÅÎì±Ìè¨Íµ¨ Ïó¨ÏùòÎèÑÎèô",
        year: 2023,
        note: `Relaxing at Hangang Park with friends, snacks and city lights.`,
        folder: "Hangan Park"
      },
      {
        id: 20,
        name: "Hongdae",
        type: "adventure",
        city: "ÏÑúÏö∏",
        address: "ÏÑúÏö∏ ÎßàÌè¨Íµ¨ ÏñëÌôîÎ°ú ÏßÄÌïò 160",
        year: 2023,
        note: `Street performances, shops and night life in Hongdae.`,
        folder: "Hongdae"
      },
      {
        id: 21,
        name: "Myeond-dong",
        type: "adventure",
        city: "ÏÑúÏö∏",
        address: "ÏÑúÏö∏ Ï§ëÍµ¨ Î™ÖÎèô2Í∞Ä",
        year: 2023,
        note: `Beauty shops, food and neon signs in Myeong-dong.`,
        folder: "Myeond-dong"
      },
      {
        id: 22,
        name: "Namsan Tower",
        type: "adventure",
        city: "ÏÑúÏö∏",
        address: "ÏÑúÏö∏ Ïö©ÏÇ∞Íµ¨ Ïö©ÏÇ∞Îèô2Í∞Ä ÏÇ∞ 1-3",
        year: 2023,
        note: `Classic Seoul view from Namsan Tower and love locks.`,
        folder: "Namsan Tower"
      },
      {
        id: 23,
        name: "Starfield COEX",
        type: "adventure",
        city: "ÏÑúÏö∏",
        address: "ÏÑúÏö∏ Í∞ïÎÇ®Íµ¨ ÏòÅÎèôÎåÄÎ°ú 513 ÏßÄÌïò1-ÏßÄÌïò2Ï∏µ, 1Ï∏µ",
        year: 2023,
        note: `The famous Starfield library and COEX area.`,
        folder: "Starfield"
      },

      // 2024
      {
        id: 24,
        name: "Cotejardin",
        type: "food",
        city: "ÏÑúÏö∏",
        address: "ÏÑúÏö∏ Ïö©ÏÇ∞Íµ¨ Î≥¥Í¥ëÎ°ú 122-1",
        year: 2024,
        note: `A warm meal and cozy atmosphere in Itaewon area.`,
        folder: "Cotejardin"
      },
      {
        id: 25,
        name: "ÏñëÌÇ§Ïä§Î≤ÑÍ±∞Ïï§ÌîºÏûê",
        type: "food",
        city: "ÏÑúÏö∏",
        address: "ÏÑúÏö∏ ÏòÅÎì±Ìè¨Íµ¨ ÎèÑÎ¶ºÎ°ú 434-1 1Ï∏µ",
        year: 2024,
        note: `Katya‚Äôs birthday and farewell party ‚Äì burgers, pizza and lots of laughter.`,
        folder: "ÏñëÌÇ§Ïä§Î≤ÑÍ±∞Ïï§ÌîºÏûê"
      },
      {
        id: 26,
        name: "Dotori Garden",
        type: "cafe",
        city: "ÏÑúÏö∏",
        address: "ÏÑúÏö∏ Ï¢ÖÎ°úÍµ¨ Í≥ÑÎèôÍ∏∏ 19-8",
        year: 2024,
        note: `First walk with Jasmine and Yulduz in a very aesthetic caf√©.`,
        folder: "Dotori Garden"
      },
      {
        id: 27,
        name: "Í∞ÄÌèâ ÌååÌÅ¨",
        type: "park",
        city: "Í≤ΩÍ∏∞ Í∞ÄÌèâ",
        address: "Í≤ΩÍ∏∞ Í∞ÄÌèâÍµ∞ Í∞ÄÌèâÏùç ÎåÄÍ≥°Î¶¨ 27-14",
        year: 2024,
        note: `Flower festival in Gapyeong, full of colors and photo spots.`,
        folder: "Í∞ÄÌèâ ÌååÌÅ¨"
      },
      {
        id: 28,
        name: "Í∑∏Î¶ºÏ†úÏûëÏÜå",
        type: "art",
        city: "ÏÑúÏö∏",
        address: "ÏÑúÏö∏ ÏÜ°ÌååÍµ¨ ÏÑùÏ¥åÌò∏ÏàòÎ°ú 290 ÏÑ±Ïö∞ÎπåÎî© 3Ï∏µ 301Ìò∏",
        year: 2024,
        note: `Painting our own artworks with Nastya, Jasmine and Yulduz.`,
        folder: "Í∑∏Î¶ºÏ†úÏûëÏÜå"
      },
      {
        id: 29,
        name: "part room",
        type: "adventure",
        city: "Ïù∏Ï≤ú",
        address: "Ïù∏Ï≤ú ÎØ∏Ï∂îÌôÄÍµ¨ Îß§ÏÜåÌôÄÎ°ú 262",
        year: 2024,
        note: `Angelina‚Äôs 23rd birthday: everyone prepared a presentation about their year and dressed as a meme ‚Äî I was the dancing Arabic cat.`,
        folder: "part room"
      },
      {
        id: 30,
        name: "Ïô∏ÎèÑ",
        type: "adventure",
        city: "Í±∞Ï†úÎèÑ",
        address: "Ïô∏ÎèÑÌå°Ìå° Ïô∏ÎèÑÏú†ÎûåÏÑ†Ïã§ÏãúÍ∞ÑÏòàÏïΩÏÑºÌÑ∞",
        year: 2024,
        note: `Two-day trip to Geoje with friends, one night in a pension and a dreamy visit to Oedo Island.`,
        folder: "Ïô∏ÎèÑ"
      },
      {
        id: 31,
        name: "Steak",
        type: "food",
        city: "ÏÑúÏö∏",
        address: "ÏÑúÏö∏ ÎßàÌè¨Íµ¨ Ïñ¥Ïö∏ÎßàÎãπÎ°ú 122-1 2Ï∏µ",
        year: 2024,
        note: `My 23rd birthday dinner with my favorite friends.`,
        folder: "Steak"
      },
      {
        id: 32,
        name: "Golden Bei Home",
        type: "home",
        city: "ÏÑúÏö∏",
        address: "ÏÑúÏö∏ ÏÑ±Î∂ÅÍµ¨ ÌôîÎûëÎ°ú 112",
        year: 2024,
        note: `One of the best apartments I lived in: with two Chinese roommates Ovidon and Yunchon, plus cats Pompom and Wolmi.`,
        folder: "Golden Bei Home"
      },
      {
        id: 33,
        name: "Koriko Cafe",
        type: "cafe",
        city: "ÏÑúÏö∏",
        address: "ÏÑúÏö∏ ÎßàÌè¨Íµ¨ ÏÑ±ÎØ∏ÏÇ∞Î°ú 165-7 ÏßÄÌïò1Ï∏µ, 1~2Ï∏µ",
        year: 2024,
        note: `A Ghibli-style caf√© moment in Seoul.`,
        folder: "Koriko Cafe"
      },
      {
        id: 34,
        name: "Nami Island",
        type: "adventure",
        city: "Í≤ΩÍ∏∞ Í∞ÄÌèâ",
        address: "Í≤ΩÍ∏∞ Í∞ÄÌèâÍµ∞ Í∞ÄÌèâÏùç Î∂ÅÌïúÍ∞ïÎ≥ÄÎ°ú 1061 1Ï∏µ",
        year: 2024,
        note: `A classic Nami Island day trip with riverside views and trees.`,
        folder: "Nami Island"
      },
      {
        id: 35,
        name: "Incheon Terminal",
        type: "adventure",
        city: "Ïù∏Ï≤ú",
        address: "Ïù∏Ï≤ú ÎØ∏Ï∂îÌôÄÍµ¨ Ïó∞ÎÇ®Î°ú 35",
        year: 2024,
        note: `Departures and arrivals ‚Äì small airport/travel memories.`,
        folder: "Incheon Terminal"
      },
      {
        id: 36,
        name: "Wolmido",
        type: "adventure",
        city: "Ïù∏Ï≤ú",
        address: "Ïù∏Ï≤ú Ï§ëÍµ¨ Î∂ÅÏÑ±Îèô1Í∞Ä 125",
        year: 2024,
        note: `Seaside park, rides and night lights in Wolmido.`,
        folder: "Wolmido"
      },
      {
        id: 37,
        name: "Lotte World",
        type: "adventure",
        city: "ÏÑúÏö∏",
        address: "ÏÑúÏö∏ ÏÜ°ÌååÍµ¨ Ïò¨Î¶ºÌîΩÎ°ú 240",
        year: 2024,
        note: `Theme park day in Lotte World with indoor and outdoor rides.`,
        folder: "Lotte World"
      },
      {
        id: 38,
        name: "ÏÑ±Ïàò",
        type: "adventure",
        city: "ÏÑúÏö∏",
        address: "ÏÑúÏö∏ ÏÑ±ÎèôÍµ¨ ÏïÑÏ∞®ÏÇ∞Î°ú 100",
        year: 2024,
        note: `Trendy caf√©s, galleries and walks around Seongsu-dong.`,
        folder: "ÏÑ±Ïàò"
      },
      {
        id: 39,
        name: "Í¥ëÌôîÎ¨∏",
        type: "adventure",
        city: "ÏÑúÏö∏",
        address: "ÏÑúÏö∏ Ï¢ÖÎ°úÍµ¨ ÏÇ¨ÏßÅÎ°ú 161",
        year: 2024,
        note: `An evening around Gwanghwamun, history and city center.`,
        folder: "Í¥ëÌôîÎ¨∏"
      },

      // 2025
      {
        id: 40,
        name: "Never Ending Pottery Studio",
        type: "art cafe",
        city: "ÏÑúÏö∏",
        address: "ÏÑúÏö∏ ÏñëÏ≤úÍµ¨ Í∞ÄÎ°úÍ≥µÏõêÎ°ú 136",
        year: 2025,
        note: `First cultural experience of the ‚Äú30 Days in Seoul‚Äù program ‚Äî pottery time.`,
        folder: "Never Ending Pottery Studio"
      },
      {
        id: 41,
        name: "ÏÑ∏Î∏êÏä§ÌîåÎ°úÏñ¥ 2Ìò∏Ï†ê",
        type: "food",
        city: "Ïù∏Ï≤ú",
        address: "Ïù∏Ï≤ú Î∂ÄÌèâÍµ¨ Î∂ÄÌèâÎåÄÎ°ú 15 Î∂ÄÌèâÏÑúÌååÎπåÎî© 7Ï∏µ",
        year: 2025,
        note: `Time with Angelina and Nastya in a pretty restaurant.`,
        folder: "ÏÑ∏Î∏êÏä§ÌîåÎ°úÏñ¥ 2Ìò∏Ï†ê"
      },
      {
        id: 42,
        name: "ÎØ∏ÏÅòÎèô",
        type: "food",
        city: "ÏÑúÏö∏",
        address: "ÏÑúÏö∏ ÎßàÌè¨Íµ¨ ÎèôÍµêÎ°ú38Í∏∏ 33-21 2Ï∏µ",
        year: 2025,
        note: `March 8th celebration and Japanese food in Hongdae.`,
        folder: "ÎØ∏ÏÅòÎèô"
      },
      {
        id: 43,
        name: "ÎèÑÎ¥âÏÇ∞",
        type: "nature",
        city: "ÏÑúÏö∏",
        address: "ÏÑúÏö∏ ÎèÑÎ¥âÍµ¨ ÎèÑÎ¥âÎèô ÏÇ∞ 31",
        year: 2025,
        note: `Hiking day at Dobongsan and fresh mountain air.`,
        folder: "ÎèÑÎ¥âÏÇ∞"
      },
      {
        id: 44,
        name: "ÎèôÎ¶ºÏ∫†ÌîÑ",
        type: "adventure",
        city: "Í≤ΩÍ∏∞ Í∞ÄÌèâ",
        address: "Í≤ΩÍ∏∞ Í∞ÄÌèâÍµ∞ Ï≤≠ÌèâÎ©¥ Î™®Íº¨ÏßÄÎ°ú 22-9",
        year: 2025,
        note: `Graduate class MT with games, campfire and late-night talks.`,
        folder: "ÎèôÎ¶ºÏ∫†ÌîÑ"
      },
      {
        id: 45,
        name: "Ïó∞Ï≤úÏó≠",
        type: "adventure",
        city: "Í≤ΩÍ∏∞ Ïó∞Ï≤ú",
        address: "Í≤ΩÍ∏∞ Ïó∞Ï≤úÍµ∞ Ïó∞Ï≤úÏùç Ïó∞Ï≤úÎ°ú 275-1",
        year: 2025,
        note: `Trip with SeoulTech Global Center to the closed Yeoncheon Station.`,
        folder: "Ïó∞Ï≤úÏó≠"
      },
      {
        id: 46,
        name: "Í∞êÏ≤úÎ¨∏ÌôîÎßàÏùÑ",
        type: "adventure",
        city: "Î∂ÄÏÇ∞",
        address: "Î∂ÄÏÇ∞ ÏÇ¨ÌïòÍµ¨ Í∞êÏ≤úÎèô 1-17",
        year: 2025,
        note: `First Busan trip and pastel-colored Gamcheon Culture Village.`,
        folder: "Í∞êÏ≤úÎ¨∏ÌôîÎßàÏùÑ"
      },
      {
        id: 47,
        name: "Ìï¥Ïö¥ÎåÄÌï¥ÏàòÏöïÏû•",
        type: "beach",
        city: "Î∂ÄÏÇ∞",
        address: "Î∂ÄÏÇ∞ Ìï¥Ïö¥ÎåÄÍµ¨ Ïö∞Îèô",
        year: 2025,
        note: `Busan seaside walk along Haeundae Beach.`,
        folder: "Ìï¥Ïö¥ÎåÄÌï¥ÏàòÏöïÏû•"
      },
      {
        id: 48,
        name: "Í≥§ÏßÄÏïîÎ¶¨Ï°∞Ìä∏ Ïä§ÌÇ§Ïû•",
        type: "adventure",
        city: "Í≤ΩÍ∏∞ Í¥ëÏ£º",
        address: "Í≤ΩÍ∏∞ Í¥ëÏ£ºÏãú ÎèÑÏ≤ôÎ©¥ ÎèÑÏ≤ôÏúóÎ°ú 278",
        year: 2025,
        note: `News1 camp ski experience at Gonjiam Resort.`,
        folder: "Í≥§ÏßÄÏïîÎ¶¨Ï°∞Ìä∏ Ïä§ÌÇ§Ïû•"
      },
      {
        id: 49,
        name: "ÎÆ§ÏßÄÏóÑÏÇ∞",
        type: "art",
        city: "Í∞ïÏõê ÏõêÏ£º",
        address: "Í∞ïÏõêÌäπÎ≥ÑÏûêÏπòÎèÑ ÏõêÏ£ºÏãú ÏßÄÏ†ïÎ©¥ Ïò§ÌÅ¨Î∞∏Î¶¨2Í∏∏ 260",
        year: 2025,
        note: `Fun Korea one-day tour ‚Äî architecture, art and nature at Museum SAN.`,
        folder: "ÎÆ§ÏßÄÏóÑÏÇ∞"
      },
      {
        id: 50,
        name: "ÌîºÎÖ∏ÌÇ§Ïò§Ïà≤",
        type: "nature",
        city: "Í∞ïÏõê ÏõêÏ£º",
        address: "Í∞ïÏõêÌäπÎ≥ÑÏûêÏπòÎèÑ ÏõêÏ£ºÏãú Ïã†Î¶ºÎ©¥ ÏÜåÏïº1Í∏∏ 72 1Ï∏µ",
        year: 2025,
        note: `‚ÄúPinocchio Forest‚Äù stop during the same tour ‚Äî dreamy wooden details.`,
        folder: "ÌîºÎÖ∏ÌÇ§Ïò§Ïà≤"
      },
      {
        id: 51,
        name: "Î™®ÎÇòÏö©Ìèâ Ïä§ÌÇ§Ïû•",
        type: "adventure",
        city: "Í∞ïÏõê ÏõêÏ£º",
        address: "Í∞ïÏõêÌäπÎ≥ÑÏûêÏπòÎèÑ ÌèâÏ∞ΩÍµ∞ ÎåÄÍ¥ÄÎ†πÎ©¥ Ïò¨Î¶ºÌîΩÎ°ú 715",
        year: 2025,
        note: `Snowy day at Mona Yongpyong ski resort.`,
        folder: "Î™®ÎÇòÏö©Ìèâ Ïä§ÌÇ§Ïû•"
      },
      {
        id: 52,
        name: "Î¨¥ÏÑ¨ÎßàÏùÑ",
        type: "nature",
        city: "Í≤ΩÎ∂Å ÏòÅÏ£º",
        address: "Í≤ΩÎ∂Å ÏòÅÏ£ºÏãú Î¨∏ÏàòÎ©¥ Î¨¥ÏÑ¨Î°ú234Î≤àÍ∏∏ 31-12",
        year: 2025,
        note: `Korea Travelmate one-day trip to a traditional riverside village.`,
        folder: "Î¨¥ÏÑ¨ÎßàÏùÑ"
      },
      {
        id: 53,
        name: "Î∂ÄÏÑùÏÇ¨",
        type: "nature",
        city: "Í≤ΩÎ∂Å ÏòÅÏ£º",
        address: "Í≤ΩÎ∂Å ÏòÅÏ£ºÏãú Î∂ÄÏÑùÎ©¥ Î∂ÄÏÑùÏÇ¨Î°ú 345",
        year: 2025,
        note: `Visit to Buseoksa temple ‚Äî peaceful, with a small ‚Äúapple hehe‚Äù memory.`,
        folder: "Î∂ÄÏÑùÏÇ¨"
      },
      {
        id: 54,
        name: "Ïö©ÏÑ§2Ìò∏ÏßÄ",
        type: "adventure",
        city: "Í≤ΩÍ∏∞ ÏïàÏÑ±",
        address: "Í≤ΩÍ∏∞ ÏïàÏÑ±Ïãú Ï£ΩÏÇ∞Î©¥ Ïö©ÏÑ§Ìò∏ÏàòÍ∏∏ 187",
        year: 2025,
        note: `Kimchi-making experience near the lake in Anseong.`,
        folder: "Ïö©ÏÑ§2Ìò∏ÏßÄ"
      },
      {
        id: 55,
        name: "ÏùòÎ¶ºÏßÄ",
        type: "nature",
        city: "Ï∂©Î∂Å Ï†úÏ≤ú",
        address: "Ï∂©Î∂Å Ï†úÏ≤úÏãú Î™®ÏÇ∞Îèô 241",
        year: 2025,
        note: `Trip to visit a friend who gave birth in Korea, with a stop at Uirimji.`,
        folder: "ÏùòÎ¶ºÏßÄ"
      },
      {
        id: 56,
        name: "Ïò§Ïù¥ÎèÑÌï¥Î≥Ä",
        type: "nature",
        city: "Í≤ΩÍ∏∞ ÏãúÌù•",
        address: "Í≤ΩÍ∏∞ ÏãúÌù•Ïãú Ï†ïÏôïÎèô 2202-4",
        year: 2025,
        note: `Korea Travelmate ‚ÄúAutumn in Two Wheels‚Äù along Oido beach.`,
        folder: "Ïò§Ïù¥ÎèÑÌï¥Î≥Ä"
      },
      {
        id: 57,
        name: "ÏÜîÎã§Î∞ïÏ≤¥ÌóòÌú¥ÏñëÎßàÏùÑ",
        type: "adventure",
        city: "Ï†ÑÎ∂Å Î¨¥Ï£º",
        address: "Ï†ÑÎ∂ÅÌäπÎ≥ÑÏûêÏπòÎèÑ Î¨¥Ï£ºÍµ∞ ÏïàÏÑ±Î©¥ Ïû•Î¨¥Î°ú 1637 1Ï∏µ",
        year: 2025,
        note: `Korea Travelmate autumn trip ‚Äî staying in a rural experience village.`,
        folder: "ÏÜîÎã§Î∞ïÏ≤¥ÌóòÌú¥ÏñëÎßàÏùÑ"
      },
      {
        id: 58,
        name: "Î®∏Î£®ÏôÄÏù∏ÎèôÍµ¥",
        type: "adventure",
        city: "Ï†ÑÎ∂Å Î¨¥Ï£º",
        address: "Ï†ÑÎ∂ÅÌäπÎ≥ÑÏûêÏπòÎèÑ Î¨¥Ï£ºÍµ∞ Ï†ÅÏÉÅÎ©¥ ÏÇ∞ÏÑ±Î°ú 359",
        year: 2025,
        note: `Wine cave visit with atmospheric underground lights.`,
        folder: "Î®∏Î£®ÏôÄÏù∏ÎèôÍµ¥"
      },
      {
        id: 59,
        name: "Î≥¥ÏùÄÏÇ¨",
        type: "nature",
        city: "Ï∂©Î∂Å Î≥¥ÏùÄ",
        address: "Ï∂©Î∂Å Î≥¥ÏùÄÍµ∞ Î≥¥ÏùÄÏùç ÏÑ±Ï£º1Í∏∏ 104",
        year: 2025,
        note: `Temple and quiet village feeling in Boeun.`,
        folder: "Î≥¥ÏùÄÏÇ¨"
      },
      {
        id: 60,
        name: "ÏõîÎ•òÏ†ï",
        type: "nature",
        city: "Ï∂©Î∂Å ÏòÅÎèô",
        address: "Ï∂©Î∂Å ÏòÅÎèôÍµ∞ Ìô©Í∞ÑÎ©¥ ÏõêÏ¥åÎ¶¨ ÏÇ∞ 20-1",
        year: 2025,
        note: `Picturesque pavilion and river view at Wolryujeong.`,
        folder: "ÏõîÎ•òÏ†ï"
      },
      {
        id: 61,
        name: "ÏïàÎèôÌïòÌöåÎßàÏùÑ",
        type: "nature",
        city: "Í≤ΩÎ∂Å ÏïàÎèô",
        address: "Í≤ΩÎ∂Å ÏïàÎèôÏãú ÌíçÏ≤úÎ©¥ ÌïòÌöåÎ¶¨ 1176-1",
        year: 2025,
        note: `Nongshim trip to UNESCO Hahoe Folk Village.`,
        folder: "ÏïàÎèôÌïòÌöåÎßàÏùÑ"
      },
      {
        id: 62,
        name: "Ìò∏Í≥ÑÏÑúÏõê",
        type: "nature",
        city: "Í≤ΩÎ∂Å ÏïàÎèô",
        address: "Í≤ΩÎ∂Å ÏïàÎèôÏãú ÎèÑÏÇ∞Î©¥ Ìá¥Í≥ÑÎ°ú 2001-36",
        year: 2025,
        note: `Confucian academy with calm, scholarly energy.`,
        folder: "Ìò∏Í≥ÑÏÑúÏõê"
      },
      {
        id: 63,
        name: "ÎèÑÏÇ∞ÏÑúÏõê",
        type: "nature",
        city: "Í≤ΩÎ∂Å ÏïàÎèô",
        address: "Í≤ΩÎ∂Å ÏïàÎèôÏãú ÎèÑÏÇ∞Î©¥ ÎèÑÏÇ∞ÏÑúÏõêÍ∏∏ 154",
        year: 2025,
        note: `Another historic Confucian academy in Andong, surrounded by nature.`,
        folder: "ÎèÑÏÇ∞ÏÑúÏõê"
      },
      {
        id: 64,
        name: "ÏõîÏòÅÎ≥¥Ìä∏",
        type: "nature",
        city: "Í≤ΩÎ∂Å ÏïàÎèô",
        address: "Í≤ΩÎ∂Å ÏïàÎèôÏãú ÏÉÅÏïÑÎèô 569",
        year: 2025,
        note: `Moonlight bridge and boat ‚Äì romantic Andong night view.`,
        folder: "ÏõîÏòÅÎ≥¥Ìä∏"
      },
      {
        id: 65,
        name: "ÏïàÎèôÍµ≠Ï†úÏª®Î≤§ÏÖòÏÑºÌÑ∞&ÏÑ∏Í≥ÑÏú†ÍµêÎ¨∏ÌôîÎ∞ïÎ¨ºÍ¥Ä",
        type: "adventure",
        city: "Í≤ΩÎ∂Å ÏïàÎèô",
        address: "Í≤ΩÎ∂Å ÏïàÎèôÏãú ÎèÑÏÇ∞Î©¥ ÏõîÏ≤úÍ∏∏ 301",
        year: 2025,
        note: `Festival at the Andong International Convention Center and World Confucian Culture Museum.`,
        folder: "ÏïàÎèôÍµ≠Ï†úÏª®Î≤§ÏÖòÏÑºÌÑ∞&ÏÑ∏Í≥ÑÏú†ÍµêÎ¨∏ÌôîÎ∞ïÎ¨ºÍ¥Ä"
      },
      {
        id: 66,
        name: "yaniyan art home",
        type: "art",
        city: "ÏÑúÏö∏",
        address: "ÏÑúÏö∏ Í∞ïÎÇ®Íµ¨ ÏïïÍµ¨Ï†ïÎ°ú14Í∏∏ 39",
        year: 2025,
        note: `Last cultural experience of the ‚Äú30 Days in Seoul‚Äù program ‚Äì cozy art home.`,
        folder: "yaniyan art home"
      },
      {
        id: 67,
        name: "ÎîîÎÆ§ÏßÄÏóÑ",
        type: "art",
        city: "ÏÑúÏö∏",
        address: "ÏÑúÏö∏ ÏÑ±ÎèôÍµ¨ ÏôïÏã≠Î¶¨Î°ú 83-21 1-4Ï∏µ",
        year: 2025,
        note: `Off-campus art class with professor and classmates at D Museum.`,
        folder: "ÎîîÎÆ§ÏßÄÏóÑ"
      },
      {
        id: 68,
        name: "ÎßàÏù¥ÏïÑÌä∏ÎÆ§ÏßÄÏóÑ ÏõêÍ∑∏Î°úÎ∏åÏ†ê",
        type: "art",
        city: "ÏÑúÏö∏",
        address: "ÏÑúÏö∏ Í∞ïÏÑúÍµ¨ Í≥µÌï≠ÎåÄÎ°ú 165 ÏõêÍ∑∏Î°úÎ∏å CÎèô 2Ï∏µ W213Ìò∏",
        year: 2025,
        note: `Alphonse Mucha exhibition at My Art Museum.`,
        folder: "ÎßàÏù¥ÏïÑÌä∏ÎÆ§ÏßÄÏóÑ ÏõêÍ∑∏Î°úÎ∏åÏ†ê"
      },
      {
        id: 69,
        name: "Íµ≠Î¶ΩÌòÑÎåÄÎØ∏Ïà†Í¥Ä",
        type: "art",
        city: "ÏÑúÏö∏",
        address: "ÏÑúÏö∏ Ï¢ÖÎ°úÍµ¨ ÏÇºÏ≤≠Î°ú 30",
        year: 2025,
        note: `Visit to MMCA Seoul with modern and contemporary art.`,
        folder: "Íµ≠Î¶ΩÌòÑÎåÄÎØ∏Ïà†Í¥Ä"
      },
      {
        id: 70,
        name: "ÏÑúÏö∏Ïà≤",
        type: "nature",
        city: "ÏÑúÏö∏",
        address: "ÏÑúÏö∏ ÏÑ±ÎèôÍµ¨ ÏÑ±ÏàòÎèô1Í∞Ä 678-1",
        year: 2025,
        note: `Walks in Seoul Forest ‚Äì deers, nature and caf√©s around.`,
        folder: "ÏÑúÏö∏Ïà≤"
      },
      {
        id: 71,
        name: "Shinseage",
        type: "adventure",
        city: "ÏÑúÏö∏",
        address: "ÏÑúÏö∏ Ï§ëÍµ¨ ÏÜåÍ≥µÎ°ú 63",
        year: 2025,
        note: `Shinsegae Department Store ‚Äì Christmas lights, food market and luxury vibes.`,
        folder: "Shinseage"
      },
      {
        id: 72,
        name: "Ï∞ΩÎçïÍ∂Å",
        type: "adventure",
        city: "ÏÑúÏö∏",
        address: "ÏÑúÏö∏ Ï¢ÖÎ°úÍµ¨ Ïú®Í≥°Î°ú 99",
        year: 2025,
        note: `Visit to Changdeokgung palace, including the secret garden.`,
        folder: "Ï∞ΩÎçïÍ∂Å"
      },
      {
        id: 73,
        name: "Í¥ëÏïàÎ¶¨Ìï¥ÏàòÏöïÏû•",
        type: "beach",
        city: "Î∂ÄÏÇ∞",
        address: "Î∂ÄÏÇ∞ ÏàòÏòÅÍµ¨ Í¥ëÏïàÌï¥Î≥ÄÎ°ú 219",
        year: 2025,
        note: `Night view of the Gwangan Bridge and city skyline at Gwangalli Beach.`,
        folder: "Í¥ëÏïàÎ¶¨Ìï¥ÏàòÏöïÏû•"
      }
    ];

    // Map type string to category key
    function mapTypeToCategoryKey(type) {
      const t = String(type || '').toLowerCase();
      if (t === 'cafe' || t === 'art cafe') return 'cafe';
      if (t === 'food') return 'food';
      if (t === 'nature' || t === 'beach' || t === 'park') return 'nature';
      if (t === 'adventure' || t === 'cinema') return 'exp';
      if (t === 'art') return 'culture';
      if (t === 'study' || t === 'university') return 'study';
      if (t === 'grocery store' || t === 'market') return 'market';
      if (t === 'home' || t === 'hospital') return 'daily';
      return 'etc';
    }

    // Add category and coords to each place
    places.forEach(p => {
      p.category = mapTypeToCategoryKey(p.type);
      p.coords = null;
    });

    /* ---------------------------
       DOM REFERENCES
       --------------------------- */
    const yearFiltersEl = document.getElementById('yearFilters');
    const typeFiltersEl = document.getElementById('typeFilters');
    const placeListEl = document.getElementById('placeList');
    const mapCategoryBadge = document.getElementById('mapCategoryBadge');
    const photoGrid = document.getElementById('photoGrid');

    const memTitle = document.getElementById('memTitle');
    const memSub = document.getElementById('memSub');
    const memType = document.getElementById('memType');
    const memCity = document.getElementById('memCity');
    const memYear = document.getElementById('memYear');
    const memAddress = document.getElementById('memAddress');
    const memNote = document.getElementById('memNote');
    const memTip = document.getElementById('memTip');
    const memBadge = document.getElementById('memBadge');

    const musicToggle = document.getElementById('musicToggle');
    const bgMusic = document.getElementById('bgMusic');

    let currentYear = 'all';
    let currentCategory = 'all';
    let activeId = null;

    /* ---------------------------
       SPARKLES EFFECT
       --------------------------- */
    function createSparkles(event, count = 15) {
      const x = event.clientX || event.pageX;
      const y = event.clientY || event.pageY;
      
      for (let i = 0; i < count; i++) {
        const sparkle = document.createElement('div');
        sparkle.className = 'sparkle';
        
        // Random size variation
        if (Math.random() > 0.7) {
          sparkle.classList.add('sparkle-large');
        } else if (Math.random() > 0.5) {
          sparkle.classList.add('sparkle-small');
        }
        
        // Random direction and distance
        const angle = (Math.PI * 2 * i) / count + Math.random() * 0.5;
        const distance = 60 + Math.random() * 80;
        const tx = Math.cos(angle) * distance;
        const ty = Math.sin(angle) * distance;
        
        sparkle.style.left = x + 'px';
        sparkle.style.top = y + 'px';
        sparkle.style.setProperty('--tx', tx + 'px');
        sparkle.style.setProperty('--ty', ty + 'px');
        
        // Random delay for more natural effect
        sparkle.style.animationDelay = (Math.random() * 0.2) + 's';
        
        document.body.appendChild(sparkle);
        
        // Remove after animation
        setTimeout(() => {
          sparkle.remove();
        }, 1200);
      }
    }

    /* ---------------------------
       MUSIC TOGGLE
       --------------------------- */
    let isPlaying = false;
    musicToggle.addEventListener('click', async () => {
      try {
        if (!isPlaying) {
          await bgMusic.play();
          isPlaying = true;
          musicToggle.querySelector('.label').textContent = 'Pause music';
          musicToggle.querySelector('.icon').textContent = '‚è∏';
        } else {
          bgMusic.pause();
          isPlaying = false;
          musicToggle.querySelector('.label').textContent = 'Play BTS instrumental';
          musicToggle.querySelector('.icon').textContent = 'üéß';
        }
      } catch (e) {
        console.warn('Music play error:', e);
      }
    });

    /* ---------------------------
       GEOCODING WITH CACHE
       --------------------------- */
    const GEOCODE_CACHE_KEY = 'korea_diary_geocode_cache';
    const CACHE_EXPIRY_DAYS = 30;

    function getGeocodeCache() {
      try {
        const cached = localStorage.getItem(GEOCODE_CACHE_KEY);
        if (!cached) return {};
        const data = JSON.parse(cached);
        const now = Date.now();
        const filtered = {};
        for (const [key, value] of Object.entries(data)) {
          if (now - value.timestamp < CACHE_EXPIRY_DAYS * 24 * 60 * 60 * 1000) {
            filtered[key] = value;
          }
        }
        return filtered;
      } catch (e) {
        return {};
      }
    }

    function setGeocodeCache(address, coords) {
      try {
        const cache = getGeocodeCache();
        cache[address] = { coords, timestamp: Date.now() };
        localStorage.setItem(GEOCODE_CACHE_KEY, JSON.stringify(cache));
      } catch (e) {
        // Ignore storage errors
      }
    }

    async function geocodePlace(place) {
      if (place.coords) return place.coords;
      const cache = getGeocodeCache();
      const cached = cache[place.address];
      if (cached) {
        place.coords = cached.coords;
        return place.coords;
      }
      const query = place.address || (place.city + ' ' + place.name);
      const url = `https://nominatim.openstreetmap.org/search?format=json&q=${encodeURIComponent(query)}&countrycodes=kr&limit=1`;
      try {
        const res = await fetch(url, {
          headers: {
            "Accept": "application/json",
            "User-Agent": "KoreaVisualDiary/1.0"
          }
        });
        const data = await res.json();
        if (data && data[0]) {
          const lat = parseFloat(data[0].lat);
          const lon = parseFloat(data[0].lon);
          const coords = [lat, lon];
          place.coords = coords;
          setGeocodeCache(place.address, coords);
          return coords;
        }
      } catch (e) {
        console.warn('Geocoding error for', place.name, e);
      }
      return null;
    }

    /* ---------------------------
       CUSTOM MARKER ICONS
       --------------------------- */
    function createMarkerIcon(category) {
      const config = CATEGORY_CONFIG[category] || CATEGORY_CONFIG.etc;
      const iconHtml = `
        <div style="
          width: 32px;
          height: 32px;
          background: rgba(252,221,157,0.95);
          border: 2px solid rgba(241,100,46,0.8);
          border-radius: 50% 50% 50% 0;
          transform: rotate(-45deg);
          display: flex;
          align-items: center;
          justify-content: center;
          box-shadow: 0 4px 12px rgba(0,0,0,0.4);
        ">
          <span style="
            transform: rotate(45deg);
            font-size: 16px;
            display: block;
          ">${config.icon}</span>
        </div>
      `;
      return L.divIcon({
        html: iconHtml,
        className: 'custom-marker',
        iconSize: [32, 32],
        iconAnchor: [16, 32],
        popupAnchor: [0, -32]
      });
    }

    /* ---------------------------
       LEAFLET MAP INIT
       --------------------------- */
    let map;
    let markersLayer;

    function initMap() {
      if (map) return;
      const southWest = L.latLng(33.0, 124.0);
      const northEast = L.latLng(38.8, 132.0);
      const bounds = L.latLngBounds(southWest, northEast);

      map = L.map('map', {
        zoomControl: false,
        attributionControl: false,
        maxBounds: bounds,
        maxBoundsViscosity: 1.0,
        minZoom: 6,
        maxZoom: 15
      }).setView([36.3, 127.8], 7);

      L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
        maxZoom: 18,
        attribution: ''
      }).addTo(map);

      markersLayer = L.layerGroup().addTo(map);

      setTimeout(() => {
        map.invalidateSize();
      }, 200);
    }

    /* ---------------------------
       HIGHLIGHT PLACE CARD
       --------------------------- */
    function highlightPlaceCard(id) {
      const cards = placeListEl.querySelectorAll('.place-card');
      cards.forEach(card => {
        if (Number(card.dataset.id) === id) {
          card.classList.add('active');
          card.scrollIntoView({ block: 'center', behavior: 'smooth' });
        } else {
          card.classList.remove('active');
        }
      });
    }

    /* ---------------------------
       UPDATE MAP MARKERS
       --------------------------- */
    async function updateMapMarkers(filteredPlaces) {
      if (!map) return;
      markersLayer.clearLayers();
      if (filteredPlaces.length === 0) return;

      const bounds = [];

      for (const p of filteredPlaces) {
        const coords = await geocodePlace(p);
        if (!coords) continue;

        const icon = createMarkerIcon(p.category);
        const marker = L.marker(coords, { icon }).addTo(markersLayer);

        marker.bindPopup(`
          <b>${p.name}</b><br/>
          ${p.city}<br/>
          ${p.address}
        `);

        marker.bindTooltip(p.name, {
          direction: 'top',
          offset: [0, -20]
        });

        marker.on('click', (e) => {
          // Get click position from map event
          const containerPoint = map.mouseEventToContainerPoint(e.originalEvent || e);
          const sparkleEvent = {
            clientX: containerPoint.x + map.getContainer().getBoundingClientRect().left,
            clientY: containerPoint.y + map.getContainer().getBoundingClientRect().top
          };
          createSparkles(sparkleEvent, 20);
          activeId = p.id;
          updateMemoryCard(p, filteredPlaces.length);
          highlightPlaceCard(p.id);
          map.setView(coords, Math.max(map.getZoom(), 11), {
            animate: true,
            duration: 0.5
          });
        });

        bounds.push(coords);
      }

      if (bounds.length > 0) {
        try {
          map.fitBounds(bounds, { padding: [30, 30], maxZoom: 9 });
        } catch (e) {
          map.setView([36.3, 127.8], 7);
        }
      } else {
        map.setView([36.3, 127.8], 7);
      }
    }

    /* ---------------------------
       YEAR FILTERS
       --------------------------- */
    function getYearsWithCounts() {
      const counts = {};
      places.forEach(p => {
        counts[p.year] = (counts[p.year] || 0) + 1;
      });
      return counts;
    }

    function buildYearFilters() {
      const counts = getYearsWithCounts();
      const years = [2022, 2023, 2024, 2025];
      yearFiltersEl.innerHTML = '';

      // Add "All" button first
      const allBtn = document.createElement('button');
      allBtn.type = 'button';
      allBtn.className = 'year-chip';
      if (currentYear === 'all') allBtn.classList.add('active');
      const totalCount = places.length;
      allBtn.innerHTML = `All <span class="count">(${totalCount})</span>`;
      allBtn.addEventListener('click', () => {
        currentYear = 'all';
        activeId = null;
        currentCategory = 'all';
        buildYearFilters();
        buildTypeFilters();
        renderPlaces();
        resetMemoryCard();
        updateMapCategoryBadge();
      });
      yearFiltersEl.appendChild(allBtn);

      // Add year buttons
      years.forEach(y => {
        const btn = document.createElement('button');
        btn.type = 'button';
        btn.className = 'year-chip';
        if (!counts[y]) btn.classList.add('disabled');
        if (y === currentYear) btn.classList.add('active');
        btn.dataset.year = y;
        btn.innerHTML = `${y} <span class="count">(${counts[y] || 0})</span>`;
        btn.addEventListener('click', () => {
          if (!counts[y]) return;
          currentYear = y;
          activeId = null;
          currentCategory = 'all';
          buildYearFilters();
          buildTypeFilters();
          renderPlaces();
          resetMemoryCard();
          updateMapCategoryBadge();
        });
        yearFiltersEl.appendChild(btn);
      });
    }

    /* ---------------------------
       CATEGORY FILTERS
       --------------------------- */
    function getCategoryCountsForYear(year) {
      const counts = {};
      places.forEach(p => {
        if (year !== 'all' && p.year !== year) return;
        const c = p.category || 'etc';
        counts[c] = (counts[c] || 0) + 1;
      });
      return counts;
    }

    function buildTypeFilters() {
      const counts = getCategoryCountsForYear(currentYear);
      typeFiltersEl.innerHTML = '';

      const allConfig = CATEGORY_CONFIG.all;
      const allBtn = document.createElement('button');
      allBtn.type = 'button';
      allBtn.className = 'tag' + (currentCategory === 'all' ? ' active' : '');
      allBtn.innerHTML = `<span class="icon">${allConfig.icon}</span><span>${allConfig.label}</span>`;
      allBtn.addEventListener('click', () => {
        currentCategory = 'all';
        activeId = null;
        buildTypeFilters();
        renderPlaces();
        resetMemoryCard();
        updateMapCategoryBadge();
      });
      typeFiltersEl.appendChild(allBtn);

      const keysInOrder = ['cafe', 'food', 'nature', 'exp', 'culture', 'study', 'daily', 'market', 'etc'];
      keysInOrder.forEach(key => {
        const cfg = CATEGORY_CONFIG[key];
        const count = counts[key] || 0;
        const btn = document.createElement('button');
        btn.type = 'button';
        btn.className = 'tag';
        if (currentCategory === key) btn.classList.add('active');
        if (!count) btn.classList.add('disabled');
        btn.innerHTML = `<span class="icon">${cfg.icon}</span><span>${cfg.label}${count ? ` (${count})` : ''}</span>`;
        btn.addEventListener('click', () => {
          if (!count) return;
          currentCategory = key;
          activeId = null;
          buildTypeFilters();
          renderPlaces();
          resetMemoryCard();
          updateMapCategoryBadge();
        });
        typeFiltersEl.appendChild(btn);
      });
    }

    /* ---------------------------
       PHOTO GALLERY
       assets/images/{year}/{folder}/1.jpg,2.jpg...
       --------------------------- */
    // Helper function to encode path with spaces for URL
    function encodeImagePath(path) {
      return path.split('/').map(part => encodeURIComponent(part)).join('/');
    }

    // Track current place to prevent photo mixing
    let currentPlaceId = null;

    function loadGalleryForPlace(place) {
      // Set current place ID to prevent mixing photos
      currentPlaceId = place.id;
      photoGrid.innerHTML = '';
      
      // Show loading indicator
      const loadingDiv = document.createElement('div');
      loadingDiv.className = 'photo-loading';
      loadingDiv.textContent = 'Loading photos...';
      photoGrid.appendChild(loadingDiv);
      
      const basePath = `assets images/${place.year}/${place.folder}/`;
      let loaded = 0;
      const imageExtensions = ['jpg', 'jpeg', 'JPG', 'JPEG', 'png', 'PNG', 'DNG'];
      const maxAttempts = 150;
      
      // Common file name patterns to try
      const patterns = [
        // Pattern: photo_*.jpg (most common) - try wider range
        (i) => `photo_5316569987013087${String(830 + i).padStart(3, '0')}_y.jpg`,
        (i) => `photo_5316569987013087${String(580 + i).padStart(3, '0')}_y.jpg`,
        (i) => `photo_5319268652404118${String(318 + i).padStart(3, '0')}_y.jpg`,
        (i) => `photo_5316569987013087${String(490 + i).padStart(3, '0')}_y.jpg`,
        (i) => `photo_5316569987013087${String(590 + i).padStart(3, '0')}_y.jpg`,
        (i) => `photo_5316569987013087${String(750 + i).padStart(3, '0')}_y.jpg`,
        (i) => `photo_5316569987013087${String(495 + i).padStart(3, '0')}_y.jpg`,
        (i) => `photo_5316569987013087${String(502 + i).padStart(3, '0')}_y.jpg`,
        (i) => `photo_5316569987013087${String(504 + i).padStart(3, '0')}_y.jpg`,
        (i) => `photo_5316569987013087${String(505 + i).padStart(3, '0')}_y.jpg`,
        (i) => `photo_5316569987013087${String(506 + i).padStart(3, '0')}_y.jpg`,
        (i) => `photo_5316569987013087${String(508 + i).padStart(3, '0')}_y.jpg`,
        (i) => `photo_5319268652404118${String(321 + i).padStart(3, '0')}_y.jpg`,
        (i) => `photo_5319268652404118${String(322 + i).padStart(3, '0')}_y.jpg`,
        (i) => `photo_5319268652404118${String(318 + i).padStart(3, '0')}_x.jpg`,
        // Pattern: IMG_*.PNG
        (i) => `IMG_${String(1960 + i).padStart(4, '0')}.PNG`,
        (i) => `IMG_${String(1970 + i).padStart(4, '0')}.PNG`,
        (i) => `IMG_${String(1980 + i).padStart(4, '0')}.PNG`,
        (i) => `IMG_${String(1990 + i).padStart(4, '0')}.PNG`,
        (i) => `IMG_${String(2000 + i).padStart(4, '0')}.PNG`,
        (i) => `IMG_${String(2010 + i).padStart(4, '0')}.PNG`,
        (i) => `IMG_${String(2020 + i).padStart(4, '0')}.PNG`,
        (i) => `IMG_${String(2030 + i).padStart(4, '0')}.PNG`,
        (i) => `IMG_${String(2060 + i).padStart(4, '0')}.PNG`,
        (i) => `IMG_${String(2070 + i).padStart(4, '0')}.PNG`,
        (i) => `IMG_${String(2080 + i).padStart(4, '0')}.PNG`,
        (i) => `IMG_${String(2090 + i).padStart(4, '0')}.PNG`,
        (i) => `IMG_${String(2290 + i).padStart(4, '0')}.PNG`,
        (i) => `IMG_${String(2300 + i).padStart(4, '0')}.PNG`,
        (i) => `IMG_${String(2310 + i).padStart(4, '0')}.PNG`,
        // Pattern: IMG_*.JPG
        (i) => `IMG_${String(1960 + i).padStart(4, '0')}.JPG`,
        (i) => `IMG_${String(1970 + i).padStart(4, '0')}.JPG`,
        (i) => `IMG_${String(1980 + i).padStart(4, '0')}.JPG`,
        (i) => `IMG_${String(1990 + i).padStart(4, '0')}.JPG`,
        (i) => `IMG_${String(2000 + i).padStart(4, '0')}.JPG`,
        (i) => `IMG_${String(2010 + i).padStart(4, '0')}.JPG`,
        (i) => `IMG_${String(2020 + i).padStart(4, '0')}.JPG`,
        (i) => `IMG_${String(2030 + i).padStart(4, '0')}.JPG`,
        (i) => `IMG_${String(2060 + i).padStart(4, '0')}.JPG`,
        (i) => `IMG_${String(2070 + i).padStart(4, '0')}.JPG`,
        (i) => `IMG_${String(2080 + i).padStart(4, '0')}.JPG`,
        (i) => `IMG_${String(2090 + i).padStart(4, '0')}.JPG`,
        (i) => `IMG_${String(2290 + i).padStart(4, '0')}.JPG`,
        (i) => `IMG_${String(2300 + i).padStart(4, '0')}.JPG`,
        (i) => `IMG_${String(2310 + i).padStart(4, '0')}.JPG`,
        // Simple numbered patterns
        (i) => `${i}.jpg`,
        (i) => `${i}.jpeg`,
        (i) => `${i}.png`,
        (i) => `${i}.JPG`,
        (i) => `${i}.JPEG`,
        (i) => `${i}.PNG`,
      ];

      // Try loading images with different patterns
      const triedFiles = new Set();
      let attemptCount = 0;
      let loadingRemoved = false;

      function tryLoadNext() {
        if (attemptCount >= maxAttempts) {
          if (!loadingRemoved && loadingDiv.parentNode) {
            loadingDiv.remove();
            loadingRemoved = true;
          }
          if (loaded === 0 && photoGrid.children.length === 0) {
            const empty = document.createElement('div');
            empty.className = 'photo-empty';
            empty.textContent = 'No photos found. Please check the folder: ' + basePath;
            photoGrid.appendChild(empty);
          }
          return;
        }

        attemptCount++;
        const patternIndex = (attemptCount - 1) % patterns.length;
        const fileIndex = Math.floor((attemptCount - 1) / patterns.length) + 1;
        const fileName = patterns[patternIndex](fileIndex);
        const fileKey = fileName.toLowerCase();

        if (triedFiles.has(fileKey)) {
          tryLoadNext();
          return;
        }
        triedFiles.add(fileKey);

        // Try all extensions
        imageExtensions.forEach(ext => {
          let testFileName = fileName;
          if (!fileName.match(/\.(jpg|jpeg|png|JPG|JPEG|PNG|DNG)$/i)) {
            testFileName = fileName.replace(/\.[^.]+$/, '') + '.' + ext;
          } else if (!fileName.toLowerCase().endsWith(ext.toLowerCase())) {
            return;
          }
          
          const fullPath = basePath + testFileName;
          const encodedPath = encodeImagePath(fullPath);
          const img = new Image();
          
          img.onload = () => {
            if (!img.complete) return;
            
            // Check if this photo still belongs to the current place
            if (currentPlaceId !== place.id) {
              return; // Don't add photo if place has changed
            }
            
            if (!loadingRemoved && loadingDiv.parentNode) {
              loadingDiv.remove();
              loadingRemoved = true;
            }
            
            const wrapper = document.createElement('div');
            wrapper.className = 'photo-item';
            wrapper.style.cursor = 'pointer';
            wrapper.title = 'Click to view full size';
            wrapper.appendChild(img);
            
            wrapper.addEventListener('click', (e) => {
              e.stopPropagation();
              e.preventDefault();
              showImageModal(img.src, place.name);
            });
            
            photoGrid.appendChild(wrapper);
            loaded++;
          };
          
          img.onerror = () => {
            // Try next
          };
          
          img.src = encodedPath;
          img.alt = `${place.name} photo`;
        });

        if (attemptCount < maxAttempts) {
          setTimeout(tryLoadNext, 20);
        } else {
          setTimeout(() => {
            // Double check place hasn't changed
            if (currentPlaceId !== place.id) {
              return;
            }
            
            if (!loadingRemoved && loadingDiv.parentNode) {
              loadingDiv.remove();
              loadingRemoved = true;
            }
            if (loaded === 0 && photoGrid.children.length === 0) {
              const empty = document.createElement('div');
              empty.className = 'photo-empty';
              empty.textContent = 'No photos found. Please check the folder: ' + basePath;
              photoGrid.appendChild(empty);
            }
          }, 500);
        }
      }

      tryLoadNext();
    }

    /* ---------------------------
       IMAGE MODAL FOR FULL-SIZE VIEW
       --------------------------- */
    function showImageModal(imageSrc, placeName) {
      console.log('Opening modal for image:', imageSrc);
      
      // Remove existing modal if any
      const existingModal = document.getElementById('imageModal');
      if (existingModal) {
        existingModal.remove();
      }

      const modal = document.createElement('div');
      modal.id = 'imageModal';
      modal.style.cssText = `
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0, 0, 0, 0.95);
        display: flex;
        align-items: center;
        justify-content: center;
        z-index: 10000;
        cursor: pointer;
        backdrop-filter: blur(10px);
      `;

      const img = document.createElement('img');
      img.src = imageSrc;
      img.alt = placeName;
      img.style.cssText = `
        max-width: 90%;
        max-height: 90%;
        object-fit: contain;
        border-radius: 12px;
        box-shadow: 0 20px 60px rgba(0, 0, 0, 0.8);
        cursor: default;
        pointer-events: auto;
      `;
      img.onerror = () => {
        console.error('Failed to load image in modal:', imageSrc);
        modal.remove();
      };

      const closeBtn = document.createElement('button');
      closeBtn.innerHTML = '‚úï';
      closeBtn.style.cssText = `
        position: absolute;
        top: 20px;
        right: 20px;
        background: rgba(255, 255, 255, 0.2);
        border: 1px solid rgba(255, 255, 255, 0.3);
        color: white;
        width: 40px;
        height: 40px;
        border-radius: 50%;
        font-size: 20px;
        cursor: pointer;
        display: flex;
        align-items: center;
        justify-content: center;
        backdrop-filter: blur(10px);
        transition: all 0.2s;
      `;
      closeBtn.onmouseover = () => {
        closeBtn.style.background = 'rgba(255, 255, 255, 0.3)';
        closeBtn.style.transform = 'scale(1.1)';
      };
      closeBtn.onmouseout = () => {
        closeBtn.style.background = 'rgba(255, 255, 255, 0.2)';
        closeBtn.style.transform = 'scale(1)';
      };

      const closeModal = () => {
        modal.style.opacity = '0';
        setTimeout(() => modal.remove(), 200);
      };

      closeBtn.addEventListener('click', (e) => {
        e.stopPropagation();
        closeModal();
      });
      modal.addEventListener('click', (e) => {
        if (e.target === modal) {
          closeModal();
        }
      });
      img.addEventListener('click', (e) => {
        e.stopPropagation();
      });

      modal.appendChild(img);
      modal.appendChild(closeBtn);
      document.body.appendChild(modal);

      // Animate in
      setTimeout(() => {
        modal.style.opacity = '1';
        modal.style.transition = 'opacity 0.2s';
      }, 10);

      // Close on Escape key
      const escapeHandler = (e) => {
        if (e.key === 'Escape') {
          closeModal();
          document.removeEventListener('keydown', escapeHandler);
        }
      };
      document.addEventListener('keydown', escapeHandler);
    }

    /* ---------------------------
       PLACES LIST
       --------------------------- */
    async function renderPlaces() {
      const filtered = places.filter(p => {
        if (currentYear !== 'all' && p.year !== currentYear) return false;
        if (currentCategory !== 'all' && p.category !== currentCategory) return false;
        return true;
      });

      placeListEl.innerHTML = '';

      filtered.forEach(p => {
        const card = document.createElement('div');
        card.className = 'place-card' + (p.id === activeId ? ' active' : '');
        card.dataset.id = p.id;

        const catCfg = CATEGORY_CONFIG[p.category] || CATEGORY_CONFIG.etc;
        card.innerHTML = `
          <div class="place-main">
            <div class="place-name">${p.name}</div>
            <div class="place-type">${catCfg.icon} ${catCfg.label}</div>
          </div>
          <div class="place-meta">${p.city} ¬∑ ${p.address}</div>
        `;
        card.title = `${p.name} ‚Äì ${p.city}`;

        card.addEventListener('click', (e) => {
          createSparkles(e, 20);
          activeId = p.id;
          renderPlaces();
          updateMemoryCard(p, filtered.length);
          updateMapCategoryBadge(p.category);
          if (map && p.coords) {
            map.setView(p.coords, Math.max(map.getZoom(), 12), {
              animate: true,
              duration: 0.5
            });
          }
        });

        placeListEl.appendChild(card);
      });

      memBadge.textContent = `${filtered.length} / ${places.length} places`;
      await updateMapMarkers(filtered);
    }

    /* ---------------------------
       MEMORY CARD
       --------------------------- */
    function resetMemoryCard() {
      memTitle.textContent = 'Choose a place';
      memSub.textContent = 'Select a pin on the map or a place from the list to open your memory card.';
      memType.innerHTML = `<span class="icon">‚ú®</span><span>TYPE</span>`;
      memCity.textContent = '‚Äì';
      memYear.textContent = '‚Äì';
      memAddress.textContent = '‚Äì';
      memNote.textContent = 'Here I will write my personal memory or one-sentence insight about this place.';
      memTip.textContent = 'Food recommendations, best time to visit, who I went with, or any small detail I want to remember.';
      photoGrid.innerHTML = `
        <div class="photo-empty">
          No photos loaded yet. Choose a place on the left or center to see its gallery.
        </div>
      `;
    }

    function getCategoryConfig(catKey) {
      return CATEGORY_CONFIG[catKey] || CATEGORY_CONFIG.etc;
    }

    function updateMemoryCard(place, countInList) {
      const catCfg = getCategoryConfig(place.category);
      const contentElements = document.querySelectorAll('.memory-content');
      contentElements.forEach(el => {
        el.style.animation = 'none';
        setTimeout(() => {
          el.style.animation = 'fadeIn 0.3s ease-in-out';
        }, 10);
      });

      memTitle.textContent = place.name;
      memSub.textContent = `${place.city} ¬∑ ${place.address}`;
      memType.innerHTML = `<span class="icon">${catCfg.icon}</span><span>${catCfg.label}</span>`;
      memCity.textContent = place.city;
      memYear.textContent = place.year;
      memAddress.textContent = place.address;

      if (place.note) {
        memNote.textContent = place.note;
      } else {
        memNote.textContent = 'I will write a short memory about this place here.';
      }

      // Category-based tips (English)
      if (place.category === 'food' || place.category === 'cafe') {
        memTip.textContent = 'Write about what you ate, your favorite menu, the mood of the place, and why you would go back.';
      } else if (place.category === 'nature') {
        memTip.textContent = 'Record the weather, season, who you went with, and how the landscape made you feel.';
      } else if (place.category === 'culture') {
        memTip.textContent = 'Note which artworks or moments impressed you the most and any ideas you got from them.';
      } else if (place.category === 'exp') {
        memTip.textContent = 'Summarize the main experience: rides, activities, special moments or challenges.';
      } else if (place.category === 'study') {
        memTip.textContent = 'Write about your study mood, your goals that day, and how this place supported your learning.';
      } else if (place.category === 'market') {
        memTip.textContent = 'List what you bought, price impressions, and small discoveries like ‚ÄúI can buy this in Korea!‚Äù.';
      } else if (place.category === 'daily') {
        memTip.textContent = 'Describe your daily routine here, people you met, and how this place felt as part of your everyday life.';
      } else {
        memTip.textContent = 'Write any emotions, lessons, or a one-line message you want to leave for your future self.';
      }

      memBadge.textContent = `${countInList} / ${places.length} places`;
      loadGalleryForPlace(place);
    }

    /* ---------------------------
       MAP CATEGORY BADGE
       --------------------------- */
    function updateMapCategoryBadge(catKey) {
      let key = catKey || currentCategory;
      if (!key || key === 'all') key = 'all';
      const cfg = getCategoryConfig(key);
      const label = cfg.label === 'All' ? 'All places' : `${cfg.label} only`;
      mapCategoryBadge.innerHTML = `<span class="icon">${cfg.icon}</span><span class="label">${label}</span>`;
    }

    /* ---------------------------
       INITIALIZATION
       --------------------------- */
    initMap();
    buildYearFilters();
    buildTypeFilters();
    renderPlaces();
    resetMemoryCard();
    updateMapCategoryBadge();
  </script>
</body>
</html>
